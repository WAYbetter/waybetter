{% extends "base_passenger.html" %}
{% load i18n %}

{% block extrahead %}
{{ block.super }}
<link rel="stylesheet" href="/static/css/nivo-slider.css" type="text/css" media="screen" />

<script src="/static/js/jquery.form.js"></script>
<script src="/static/js/ordering.js"></script>
<script src="/static/js/jquery.nivo.slider.pack.js" type="text/javascript"></script>

<script src="http://api.navigator.telmap.com/maps/api/js?sensor=false"></script>
<script>
    $(document).ready(function() {
        OrderingHelper.init({
            resolve_address_url:        "{% url ordering.passenger_controller.resolve_address %}",
            resolve_coordinate_url:     "{% url ordering.passenger_controller.resolve_coordinates %}",
            estimation_service_url:     "{% url ordering.passenger_controller.estimate_ride_cost %}",
            not_a_passenger_response:   "{{ not_a_passenger }}",
            not_a_user_response:        "{{ not_a_user }}",
            telmap_user:                "{{ telmap_user }}",
            telmap_password:            "{{ telmap_password}}",
            telmap_languages:           "{{ telmap_languages }}",
            address_helper_msg_from:    "{% trans 'Full Pickup Address: (Street Number City)' %}",
            address_helper_msg_to:      "{% trans 'Full Drop-off Address: (Street Number City)' %}",
            autocomplete_msg:           "{% trans '(Street Number City) and Select:' %}",
            address_not_resolved_msg:   "{% trans 'The address is not resolved' %}",
            pick_me_up_msg:             "{% trans 'Pick Me Up' %}",
            sending_msg:                "{% trans 'Sending...' %}",
            estimation_msg:             "{% trans 'Fill pickup and dropoff for price and time estimation ' %}"
        });
        $("#tabs").tabs({
            {% if request.user.passenger %}
            selected: 0,
            {% else %}
            selected: 2,
            {% endif %}
            ajaxOptions: {
                error: function(xhr, status, index, anchor) {
                    $(anchor.hash).html("{% trans "We're sorry, but an error occurred while loading this page." %}");
                }
            }
        });
        SelectFromHistoryHelper.init($("#tabs"), { fetch_address_url: "{% url ordering.passenger_controller.get_order_address %}" });
        $("#feedback_peal").click(function() {
            Registrator.openFeedbackDialog();
        });
        $("#keep_me_updated").click(function() {
            Registrator.openMobileInterestDialog();

        });
        
        $("#slider").nivoSlider({
            controlNav: false,
            directionNav: false,
            pauseTime:4000,
            slices:1,
            animSpeed:700,
            effect: "fade",
            startSlide: 0
        });

        $("#id_from_raw").focus();
        // prevent input fields and submit button from ordering on 'enter'
        $("#order_form input[type!='hidden']").add("#order_form button[type='submit']").keydown(function(e) {
            if (e.keyCode == 13){
                e.preventDefault();
            }
        });

    });

</script>
<style type="text/css">
</style>
{% endblock %}

{% block content %}
                <div id="roller">
                    <span class="img fade left-fade"></span>
                    <span class="img fade right-fade"></span>
                    {% if LANGUAGE_BIDI %}
                        <marquee behavior="scroll" scrollamount="1" direction="right" width="870">
                            {% trans 'WAYbetter are happy to announce our Tel Aviv pilot in collaboration with the "Meshuhrar Taxis" station' %}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% trans "We hope you'll enjoy the service and give us feedback so we can improve (bottom right corner)" %}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% trans 'Enjoy your ride!' %}
                        </marquee>
                    {% else %}
                        <marquee behavior="scroll" scrollamount="1" direction="left" width="870">
                            {% trans 'WAYbetter are happy to announce our Tel Aviv pilot in collaboration with the "Meshuhrar Taxis" station' %}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% trans "We hope you'll enjoy the service and give us feedback so we can improve (bottom right corner)" %}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% trans 'Enjoy your ride!' %}
                        </marquee>
                    {% endif %}
				</div>
				<div id="yellow_header" class="round">
					<span id="taxi_tab" class="img"><h1>{% trans 'TAXI' %}</h1></span>
					<div>
						<p>
							{% trans 'Book Now (FREE)' %}
						</p>
					</div>
				</div>
                <div class="gray_header">
					<form id="order_form" method="post" action="{% url ordering.passenger_controller.book_order %}">
                        {% csrf_token %}
                        {% for field in form %}
                            {% if field.name in hidden_fields %}
                                {{ field.as_hidden }}
                            {% else %}
                                <input type="hidden" id="id_geocoded_{{ field.name }}" name="geocoded_{{ field.name }}"/>
                            {%  endif %}
                        {% endfor %}
                        <ul>
                            <li>
                                <input type=text class="big_text a_marker marker_disabled" id="id_from_raw" name="from_raw" placeholder="{% trans 'Enter pickup address' %}"/>
                            </li>
                            <li>
                                <input type=text class="big_text b_marker marker_disabled" id="id_to_raw" name="to_raw" placeholder="{% trans 'Enter drop-off address' %}"/>
                            </li>
                        </ul>
						<button type=submit class="order_button" id="order_button">{% trans 'Pick Me Up' %}</button>
					</form>
					<div id="map_container">
                        <div id="map"></div>
                        <div id="map_overlay_left"></div>
                        <div id="map_overlay_top"></div>
                        <div id="ride_cost_estimate"></div>
					</div>
                    <div class="clear"></div>
				</div>
        <div id="tabs" class="main_tabs_margin_top">
        {% if request.user.passenger %}
                <ul>
                    <li><a title="history" id="history_tab_btn" href="{% url ordering.passenger_controller.get_passenger_orders_history %}">{% trans 'Ride History' %}</a></li>
                    <li><a title="profile" id="profile_tab_btn" href="{% url ordering.passenger_controller.profile_page %}">{% trans 'My Profile' %}</a></li>
                    <li><a title="stations" id="stations_tab_btn" href="{% url ordering.passenger_controller.stations_tab %}">{% trans 'Taxi Stations' %}</a></li>
                    <li><a title="mobile" id="mobile_tab_btn" href="#mobile">{% trans 'Mobile' %}</a></li>
                </ul>
            {% include 'mobile_tab.html' %}
        {% else %}
            <ul>
                <li><a title="stations" href="{% url ordering.passenger_controller.stations_tab %}">{% trans 'Taxi Stations' %}</a></li>
                <li><a title="mobile" href="#mobile">{% trans 'Mobile' %}</a></li>
                <li><a title="whats_this" href="#about">{% trans "What's This?" %}</a></li>
            </ul>
            {% include 'mobile_tab.html' %}
            <div id="about" style="text-align:center">
                <div class="about_text">
                    <h1>{% trans 'WAYbetter offers the fastest and easiest way to get a taxi!' %}</h1>
                    <p>
                        {% trans "We are partnering with the best taxi stations in your city, so all you have to do is push the yellow button. We'll do the rest" %}
                    </p>
                </div>
                <div id="slider">
                    <img src="/static/images/anim_1.png" alt="" />
                    <img src="/static/images/anim_2.png" alt="" />
                    <img src="/static/images/anim_3.png" alt="" />
                </div>
            </div>
        {% endif %}

        </div>

        <div id="dialog"></div>
    <div id="feedback_peal"></div>
{% endblock content %}