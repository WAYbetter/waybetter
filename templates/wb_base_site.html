{% extends "wb_base.html" %}
{% load i18n %}
{% load value_from_settings %}

{% block bodyclass %}base-site{% endblock %}

{% block body %}
    <!-- Container -->
    <div id="main-container">

        {% if not is_popup %}
            <!-- Header -->
            <div id="header-container">
                <div id="site-header">
                    <div class="clickable" id="wb_logo"></div>
                    {% block header_links %}
                        <ul class="links hz">
                            <li class="first">
                                <span id="lang_top" class="change-lang-top menu_link clickable">
                                    {% for lang in LANGUAGES %}
                                        {% if lang.0 == LANGUAGE_CODE %}
                                            {{ lang.1 }}
                                        {% endif %}
                                    {% endfor %}
                                </span>
                                <span class="change-lang-top dropdown-trigger"></span>
                            </li>
                            <li><a class="menu_link" href="{% url the_service %}">{% trans "The Service" %}</a></li>
                            <li>
                                {% if request.user.is_authenticated %}
                                    <span class="menu_link bold">{% trans "Hi" %}
                                        {% if request.user.first_name %}
                                            {{ request.user.first_name }}
                                        {% else %}
                                            {{ request.user.username }}
                                        {% endif %}
                                    </span>
                                    <a class="menu_link" href="{% url auth_logout %}">({% trans "Log Out" %})</a>
                                {% else %}
                                    <a class="menu_link" href="{% url auth_login %}">{% trans "Log-in" %}</a>
                                {% endif %}
                            </li>
                        </ul>
                    {% endblock %}
                    <div class="clear"></div>
                    <form action="/i18n/setlang/" method="post" id="lang_form" class="hidden">
                        {% csrf_token %}
                        <input type="hidden" name="language" id="language"/>
                        <ul class="wbdropdown-list">
                            <li data-code="he" class="clickable">עברית</li>
                            <li data-code="en" class="clickable">English</li>
{#                            <li data-code="" class="disabled">Русский</li>#}
{#                            <li data-code="" class="disabled">français</li>#}
                        </ul>
                    </form>
                </div>
            </div>
            <!-- END Header -->
        {% endif %}


        <!-- Content -->
        <div class="clear"></div>

        <div id="content-container" class="{% block mainclass %}{% endblock %}">

            {% block pre_content %}
                <div id="top-container">
                    <div id="top-left">
                        {% block top_left %}{% endblock %}
                    </div>
                    <div id="top-right">
                        {% block top_right %}{% endblock %}
                    </div>
                    <div class="clear"></div>
                </div>
            {% endblock %}

            <div id="site-content">
                {% block content %}{% endblock content %}
            </div>

            {% block post_content %}
                <div id="values_learnmore">
                    <div class="service learnmore-content wb-tooltip">
                        <div class="header">WAYbetter {% trans "Service" %}</div>
                        <div class="content">{% trans "learnmore_service_content" %}</div>
                    </div>
                    <div class="community learnmore-content wb-tooltip">
                        <div class="header">WAYbetter {% trans "Community" %}</div>
                        <div class="content">{% trans "learnmore_community_content" %}</div>
                    </div>
                    <div class="env learnmore-content wb-tooltip">
                        <div class="header">WAYbetter {% trans "Environment" %}</div>
                        <div class="content">{% trans "learnmore_environment_content" %}</div>
                    </div>
                    <div class="eff learnmore-content wb-tooltip">
                        <div class="header">WAYbetter {% trans "Efficiency" %}</div>
                        <div class="content">{% trans "learnmore_efficiency_content" %}</div>
                    </div>
                </div>

                <div id="wb_values">
                    <div class="value service" data-value-name="service">
                        <span class="header">{% trans "Service" %}</span>
                        {% trans "gist_service_content" %}
                    </div>
                    <div class="value community" data-value-name="community">
                        <span class="header">{% trans "Community" %}</span>
                        {% trans "gist_community_content" %}
                    </div>
                    <div class="value env" data-value-name="env">
                        <span class="header">{% trans "Environment" %}</span>
                        {% trans "gist_environment_content" %}
                    </div>
                    <div class="value eff last" data-value-name="eff">
                        <span class="header">{% trans "Efficiency" %}</span>
                        {% trans "gist_efficiency_content" %}
                    </div>
                </div>
            {% endblock %}
        </div>

        <div class="clear"></div>
        <!-- END Content -->

        {% if not is_popup %}
            <div id="footer-container">
                <div id="site-footer">
                    {% block footer %}
                        <div id="sitemap">
                            <ul>
                                <li>WAYbetter</li>
                                <li><a href="{% url wb_home %}">{% trans "Home" %}</a></li>
                                <li><a>{% trans "Mobile" %}</a></li>
                                <li><a href="{% url terms %}">{% trans "Terms of Use" %}</a></li>
                                <li><a href="{% url privacy %}">{% trans "Privacy Policy" %}</a></li>
                            </ul>
                            <ul>
                                <li><a>{% trans "About" %}</a></li>
                                <li><a href="{% url about_us %}">{% trans "About Us" %}</a></li>
                                <li><a href="{% url the_service %}">{% trans "The Service" %}</a></li>
                                <li><a href="{% url faq %}">{% trans "FAQ" %}</a></li>
                                <li><a>{% trans "Press" %}</a></li>
                                <li><a href="{% url contact %}">{% trans "Contact Us" %}</a></li>
                            </ul>
                            <ul>
                                <li><a>{% trans "Community" %}</a></li>
                                <li><a href="{% value_from_settings FACEBOOK_APP_URL%}">{% trans "Facebook" %}</a></li>
                                <li><a>{% trans "Twitter" %}</a></li>
                                <li><a>{% trans "Stations" %}</a></li>
                            </ul>

                            <ul>
                                {% if request.user.is_authenticated %}
                                    <li><a>{% trans "My Account" %}</a></li>
                                    <li><a href="{% url my_rides %}">{% trans "Rides" %}</a></li>
                                    <li><a>{% trans "Profile" %}</a></li>
                                    <li><a href="{% url auth_logout %}">{% trans "Log Out" %}</a></li>
                                {% else %}
                                    <li><a>{% trans "Account" %}</a></li>
                                    <li><a href="{% url auth_login %}">{% trans "Log In" %}</a></li>
                                    <li>
                                        <a href="{% url sharing.passenger_controller.registration %}">{% trans "Join" %}</a>
                                    </li>
                                {% endif %}

                            </ul>
                        </div>
                        <div id="footer_tools">
                            <div class="clickable ltr">
                                <div class="footer-icon lang change-lang-footer"></div>
                                <div class="lang-code change-lang-footer ">
                                    {{ LANGUAGE_CODE|capfirst }}
                                    <span class="dropdown-trigger white change-lang-footer"></span>
                                </div>
                            </div>
                            <div class="footer-icon fb clickable"></div>
                            <div class="footer-icon tt"></div>
                        </div>
                        <div class="clear"></div>
                    {% endblock %}
                    {% block post_footer %}{% endblock %}
                </div>
                {% block copyright %}
                   <div id="copyright-container">
                       <div id="copyright" class="ltr">© 2011 WAYbetter™ LTD. All rights reserved. Patent pending.</div>
                   </div>
                {% endblock %}
            </div>
        {% endif %}

    </div>
    <!-- END Container -->

{% endblock body %}

{% block extrastyle %}
    {{ block.super }}
{% endblock %}

{% block scripts %}
    <script type="text/javascript"
            src="http://ajax.microsoft.com/ajax/jquery.validate/1.7/jquery.validate.pack.js"></script>
    {{ block.super }}

    <!-- when not dev these scripts are already included in the concatenated js -->
    {% if DEV %}
        <!-- scripts concatenated and minified via ant build script-->
        <script type="text/javascript" src="/static/js/mylibs/jquery.ui.stars.min.js"></script>
        <script type="text/javascript" src="/static/js/mylibs/jquery.placeheld.min.js"></script>
        <script type="text/javascript" src="/static/js/mylibs/jquery.marquee.js"></script>
        <script type="text/javascript" src="/static/js/mylibs/jquery.form.js"></script>
        <script type="text/javascript" src="/static/js/mylibs/jquery.ajax_forms.js"></script>
        <script type="text/javascript" src="/static/js/mylibs/jquery.ajax_forms.validation.js"></script>
        <script type="text/javascript" src="/static/js/mylibs/jquery.formset.min.js"></script>
        <script type="text/javascript" src="/static/js/mylibs/jquery.nivo.slider.pack.min.js"></script>

        <script type="text/javascript" src="/static/js/mylibs/tooltip.js"></script>

        <script type="text/javascript" src="/static/js/helpers.js"></script>
        <!-- end scripts-->
    {% endif %}

{% endblock scripts %}

{% block doc_ready %}
    {{ block.super }}
    <script type="text/javascript">
        $(document).ready(function() {
            $("html").click(function(e) {
                var $target = $(e.target);
                if (!($target.hasClass("change-lang-top") || $target.hasClass("change-lang-footer")))
                    $("#lang_form").hide();
            });
            $("#wb_logo").click(function() {
                window.location.href = "{% url wb_home %}";
            });
            $(".change-lang-top, .change-lang-footer").click(function() {
                var $anchor = ($(this).hasClass("change-lang-top")) ? $("#lang_top") : $(".footer-icon.lang");
                var offset = $anchor.offset();
                offset.top = offset.top + 20;
                $("#lang_form").show().offset(offset);
            });
            $("#lang_form li").click(function() {
                var code = $(this).data("code");
                if (code != "{{ LANGUAGE_CODE }}" && !$(this).hasClass("disabled")) {
                    $("#lang_form #language").val(code);
                    $("#lang_form").submit();
                }
            });
            $(".footer-icon.fb").click(function() {
                window.location.href = "{% value_from_settings FACEBOOK_APP_URL%}";
            });
            $("#wb_values .value").each(function() {
                var name = $(this).data("value-name");
                var position, left;
                if ($("html").hasClass("rtl")) {
                    position = "center right";
                    left = 6;
                    if (name == "service" || name == "community") {
                        position = "center left";
                        left = -left;
                    }
                }
                else {
                    position = "center left";
                    left = -6;
                    if (name == "service" || name == "community") {
                        position = "center right";
                        left = -left;
                    }
                }
                $(this).tooltip({
                    effect: 'fade',
//                    relative: true,
                    delay: 3,
                    position: position,
                    offset: [-80, left],
                    tip: "#values_learnmore ." + name,
                    events:{
                        def: "mouseover, mouseleave"
                    }
                });
            });
        });
    </script>
{% endblock %}